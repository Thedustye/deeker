var WB=window.WB||{};WB.DIPSettings={init:function($){var that=WB.DIPSettings;that.switchAction($);that.analytics($);that.checkVersion();var magicpostTips=localStorage.getItem("wbMagicpostTipsDLIP");!magicpostTips&&wbui.open({title:"温馨提示",content:'<div>由于产品线调整，WP资源下载管理插件正式整合到<a href="https://www.wbolt.com/plugins/magicpost?ref=dip-alert" class="link" target="magicpost">Magicpost插件</a>，该插件将包括定时发布、文章搬家、HTML清理、下载管理和社交分享等模块。</div>',btn:["查看详情"],maskClose:false,yes:function(){localStorage.setItem("wbMagicpostTipsDLIP",true);window.open("https://www.wbolt.com/plugins/magicpost?ref=dip-alert")},end:function(){localStorage.setItem("wbMagicpostTipsDLIP",true)}})},checkVersion:function(){jQuery.post(ajaxurl,{action:"wb_dlipp",do:"chk_ver"},function(ver){ver=jQuery.trim(ver);ver=ver.replace(/\s+/,"");if(ver){jQuery("#version_tips").show();jQuery("#version_tips .ver").html(ver)}})},switchAction:function($,obj){var $obj=obj||$(".wb-switch[data-target]");$obj.on("change",function(){var me=$(this),$target=$(me.data("target"));if(me.prop("checked")){me.attr("data-value","true");$target.addClass("active")}else{me.attr("data-value","false");$target.removeClass("active")}})},analytics:function($){var _source=$("[data-wba-source]").length&&$("[data-wba-source]").data("wba-source")||window.wbaSource||document.domain;$("a[data-wba-campaign]").each(function(){var me=$(this),_campaign=me.data("wba-campaign"),_media=me.data("wba-media")||"link",_url=me.attr("href");_url+=_url.match("[?]")?"&":"?";_url+="utm_source="+_source;_url+="&utm_media="+_media;_url+="&utm_campaign="+_campaign;me.attr("href",_url)})}};jQuery(document).ready(function($){WB.DIPSettings.init($);$("#optionsframework-wrap").find("input,textarea").on("change",function(){$(window).on("beforeunload",function(){return confirm("您修改的设置尚未保存，确定离开此页面吗？")});$("#optionsframework-submit").addClass("sticky-bottom")});$("#optionsframework-submit .wbs-btn-primary").on("click",function(){$(window).unbind("beforeunload")})});